#!/usr/bin/env bash

function bounding_box_specs() {
    find spec/ -name \*bounding_box\*_spec.rb
}

function slack_specs() {
    find spec/ -name \*_spec.rb | grep --regex slack --regex find_controller_spec
}

function ms_teams_specs() {
    find spec/ -name \*_spec.rb | grep --regex ms_teams
}

function search_specs() {
    find spec/ -name \*_spec.rb | grep --regex search/v2 \
				       --regex graphql/directory_departments \
				       --regex find_controller_spec \
				       --regex searchkick \
				       --regex bookings/search \
				       --regex search/manager \
				       --regex manager/search \
				       --regex multi_search \
				       --regex graphql/search
}

function printing_specs() {
    find spec/ -name \*_spec.rb | grep -e print -e svg -e floor_detailed
}

function simple_floor_plan_specs() {
    find spec/ -name \*simple\*_spec.rb | grep -v simple_search
}

function dedup() {
    cat - | tr " " "\n" | sort -u
}

fail() {
    echo "$@" 1>&2
    exit 1
}

while [ -n "$1" ]
do
    type="$1"
    shift

    case "$type" in
	bounding-box*)
	    bounding_box_specs
	    ;;
	floor-plan*)
	    echo $(simple_floor_plan_specs) $(printing_specs) $(bounding_box_specs)
	    ;;
	print*)
	    printing_specs
	    ;;
	ms-teams|teams)
	    ms_teams_specs
	    ;;
	simple*)
	    simple_floor_plan_specs
	    ;;
	slack-short)
	    slack_specs | grep -v -e find_controller_spec -e employee_slack_search_spec
	    ;;
	slack)
	    slack_specs
	    ;;
	slack-desk-booking)
	    slack_specs | grep desk_booking
	    ;;
	search)
	    search_specs
	    ;;
	*)
	    fail "Usage: $0 TYPE"
	    ;;
    esac
done
