#!/usr/bin/env bash

export NODE_OPTIONS='--max-old-space-size=8120'
export PATH="$PATH:~/bin"

set-xterm-title "OSS webpack watcher"

. "$HOME/.rvm/scripts/rvm"
. "$HOME/.nvm/nvm.sh"

## Commenting out due to Internet connectivity outage:
#    && rvm get stable \
#    && rvm install "$(cat .ruby-version)" \

cd ~/projects/oss/huddle \
    && rvm use "$(cat .ruby-version)@$(cat .ruby-gemset)" --create \
    && bundle install \
    && nvm install "$(cat .node-version)" \
    && nvm use "$(cat .node-version)" \
    && (yarn install --check-files --frozen-lockfile --ignore-optional) \
    && RAILS_ENV=development bin/webpack-watcher --inline
